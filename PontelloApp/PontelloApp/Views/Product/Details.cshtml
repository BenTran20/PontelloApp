@model PontelloApp.Models.Product

<div class="mb-3 d-flex justify-content-between align-items-center">
    <partial name="_BackToList"/>

    <a asp-controller="AddProductVariant"
       asp-action="Index"
       asp-route-id="@Model.ID"
       class="btn btn-primary btn-sm">
        Manage Variants
    </a>
</div>

<h1 class="mb-4">@Model.ProductName</h1>

<div class="row">
    <!-- PRODUCT INFO -->
    <div class="col-md-5">
        <div class="card shadow mb-4">
            <div class="card-header fw-bold">
                Product Information
            </div>

            <div class="card-body">
                <dl class="row mb-0">
                    <dt class="col-sm-4">Handle</dt>
                    <dd class="col-sm-8">@Model.Handle</dd>

                    <dt class="col-sm-4">Vendor</dt>
                    <dd class="col-sm-8">@Model.Vendor.Name</dd>

                    <dt class="col-sm-4">Category</dt>
                    <dd class="col-sm-8">@Model.Category?.FullCategory</dd>

                    <dt class="col-sm-4">Type</dt>
                    <dd class="col-sm-8">@Model.Type</dd>

                    <dt class="col-sm-4">Tag</dt>
                    <dd class="col-sm-8">@Model.Tag</dd>

                    <dt class="col-sm-4">Status</dt>
                    <dd class="col-sm-8">
                        @if (Model.IsActive)
                        {
                            <span class="badge bg-success">Active</span>
                        }
                        else
                        {
                            <span class="badge bg-secondary">Archived</span>
                        }
                    </dd>

                    <dt class="col-sm-4">Description</dt>
                    <dd class="col-sm-8">
                        @Html.Raw(Model.Description)
                    </dd>
                </dl>
            </div>
        </div>
    </div>

    <!-- VARIANTS -->
    <div class="col-md-7">
        <div class="card shadow">
            <div class="card-header fw-bold d-flex justify-content-between">
                Variants
                <span class="text-muted small">
                    @Model.Variants?.Count() total
                </span>
            </div>

            <div class="card-body p-0">
                <table class="table table-hover align-middle mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>SKU</th>
                            <th>Options</th>
                            <th>Price</th>
                            <th>Compare</th>
                            <th>Stock</th>
                            <th>Weight</th>
                            <th>Policy</th>
                            <th>Status</th>
                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var v in Model.Variants ?? Enumerable.Empty<PontelloApp.Models.ProductVariant>())
                        {
                            <tr>
                                <td><strong>@v.SKU_ExternalID</strong></td>

                                <td>
                                    @string.Join(", ",
                                    v.Options?.Select(o => $"{o.Name}: {o.Value}")
                                    ?? new List<string>())
                            </td>

                            <td>@v.UnitPrice.ToString("C")</td>

                            <td>
                                @(v.CompareAtPrice.HasValue? v.CompareAtPrice.Value.ToString("C")
                                                                : "-")
                            </td>

                                <td>@v.StockQuantity</td>

                                <td>@v.Weight</td>

                                <td>@v.InventoryPolicy</td>

                                <td>
                                @if (v.Status)
                                    {
                                        <span class="badge bg-success">Active</span>
                                    }
                                    else
                                    {
                                        <span class="badge bg-secondary">Inactive</span>
                                    }
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
